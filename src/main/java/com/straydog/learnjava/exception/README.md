# Java异常处理

## 什么是异常？

**异常**是程序中的一些错误，但并不是所有的错误都是异常，并且错误有时候是可以避免的；

有异于常态，和正常情况不一样，有错误的出现，阻止方法或当前作用于继续执行的，**异常**


- 比如说，你的代码少了一个分号，那么运行出来结果是提示是错误 `java.lang.Error`；
- 如果你用`System.out.println(11/0)`，那么你是因为你用`0`做了除数，会抛出 `java.lang.ArithmeticException` 的异常。

## 异常发生的原因

- 用户输入了非法数据。
- 要打开的文件不存在。
- 网络通信时连接中断，或者`JVM`内存溢出。

## 异常的作用
- 正确的处理异常能够将异常错误提示给编程人员或者是用户，使本来已经中断了的程序一适当的方式继续运行或是退出，
并且能够保存用户当前的操作数据或是进行数据回滚，或是以安全的方式退出程序，最后再将系统占用的资源释放掉


## Java的异常

**异常**是针对方法来说的，*抛出*、*声明抛出*、*捕获*和*处理异常*都是在方法中进行的

### Java异常分类

- **检查性异常**：最具代表的检查性异常是用户错误或问题引起的异常，这是程序员无法预见的。例如要打开一个不存在文件时，一个异常就发生了，这些异常在编译时不能被简单地忽略。
- **运行时异常**： 运行时异常是可能被程序员避免的异常。与检查性异常相反，运行时异常可以在编译时被忽略。
- **错误**： 错误不是异常，而是脱离程序员控制的问题。错误在代码中通常被忽略。例如，当栈溢出时，一个错误就发生了，它们在编译也检查不到的。

### 名次解释

1. **检查性异常**: 不处理编译不能通过
2. **非检查性异常**:不处理编译可以通过，如果有抛出直接抛到控制台
3. **运行时异常**: 就是非检查性异常
4. **非运行时异常**: 就是检查性异常

### Exception 类的层次
![Java异常结构图](http://img.my.csdn.net/uploads/201211/27/1354002637_9416.png)

- `Throwable` 是所有异常的根，`java.lang.Throwable`
- `Error` 是错误，`java.lang.Error`
- `Exception` 是异常，`java.lang.Exception`


## Java异常处理机制

1. 捕获异常
  - 在方法中用`try...catch`或是`try...catch..finally`语句捕获并处理异常，`catach`语句可以有多个，用来匹配多个异常


```java

 try{
  程序代码
 }catch(异常类型1 异常的变量名1){
  程序代码
 }catch(异常类型2 异常的变量名2){
  程序代码
 }finally{
  程序代码
 }

```

2.  抛出异常
  - 当一个方法出现错误引发异常时，方法创建异常对象并交付运行时系统，异常对象中包含了异常类型和异常出现时的程序状态等异常信息。运行时系统负责寻找处置异常的代码并执行

### throw 和throws的区别
- `throws`
    - 如果一个方法没有捕获一个检查性异常，那么该方法必须使用 `throws` 关键字来声明。
    - `throws` 关键字放在方法签名的尾部。
    - 一般该异常无法处理，抛给程序上层处理

    ```java
    语法：[(修饰符)](返回值类型)(方法名)([参数列表])[throws(异常类)]{......}
    ```

- `throw` 使用 `throw`关键字抛出一个异常，无论它是新实例化的还是刚捕获到的
   - 具体抛出某个异常的动作

- `throw`与`throws`的比较
  1. `throws`出现在方法函数头；而`throw`出现在函数体。
  2. `throws`表示出现异常的一种可能性，并不一定会发生这些异常；throw则是抛出了异常，执行throw则一定抛出了某种异常对象。
  3. 两者都是消极处理异常的方式（这里的消极并不是说这种方式不好），只是抛出或者可能抛出异常，但是不会由函数去处理异常，真正的处理异常由函数的上层调用处理。

### 异常处理的目的

`Java`异常处理的目的是 **提高程序的健壮性** ，你可以在`catch`和`finally`代码块中给程序一个修正机会，使得程序不因异常而终止或者流程发生以外的改变。
同时，通过获取Java异常信息，也为程序的开发维护提供了方便，一般通过异常信息就很快就能找到出现异常的问题（代码）所在


## 异常链

- 什么是异常链

   - 有的时候，我们可以把捕获的异常包装成一个新的异常，然后再新的异常里添加对原始异常的引用，再把这个新的异常抛出，就像链式反应一样，一个导致另外一个。



异常需要封装和传递，我们在进行系统开发的时候，不要“吞噬”异常，也不要“赤裸裸”的抛出异常，封装后在抛出，或者通过异常链传递，可以达到系统更健壮、友好的目的

## 声明自定义异常

编写自己的异常类时需要记住下面的几点:

1. 所有异常都必须是 `Throwable` 的子类。
2. 如果希望写一个检查性异常类，则需要继承 `Exception` 类。
3. 如果你想写一个运行时异常类，那么需要继承 `RuntimeException` 类。

```java
class MyException extends Exception{

}
```